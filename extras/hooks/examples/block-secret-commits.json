{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "if echo \"$CLAUDE_TOOL_INPUT\" | grep -qE 'git\\s+(commit|add)'; then staged=$(git diff --cached --name-only 2>/dev/null); for f in $staged; do if echo \"$f\" | grep -qE '\\.(env|pem|key)$|credentials|secret'; then echo 'BLOCKED: Attempting to commit potentially sensitive file: '$f; exit 2; fi; if [ -f \"$f\" ] && grep -qE '(sk-or-v1-|sk-[a-zA-Z0-9]{40,}|AKIA[A-Z0-9]{16}|ghp_[a-zA-Z0-9]{36})' \"$f\" 2>/dev/null; then echo 'BLOCKED: File '$f' appears to contain API keys or secrets'; exit 2; fi; done; fi; exit 0"
          }
        ]
      }
    ]
  }
}
